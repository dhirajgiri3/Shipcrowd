{
  "info": {
    "name": "Shipcrowd Master Collection",
    "description": "Master collection for all Shipcrowd API endpoints, organized by functional area. This collection includes authentication, security, KYC, notifications, and business functionality.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "2.0.0"
  },
  "item": [
    {
      "name": "1. Authentication",
      "description": "Authentication and user management endpoints",
      "item": [
        {
          "name": "Register User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"{{userEmail}}\",\n    \"password\": \"{{userPassword}}\",\n    \"name\": \"{{userName}}\",\n    \"role\": \"{{userRole}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/register",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "register"
              ]
            },
            "description": "Register a new user in the Shipcrowd system"
          },
          "response": []
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData && jsonData.accessToken) {",
                  "    pm.environment.set('accessToken', jsonData.accessToken);",
                  "}",
                  "if (jsonData && jsonData.user && jsonData.user.id) {",
                  "    pm.environment.set('userId', jsonData.user.id);",
                  "}",
                  "if (jsonData && jsonData.user && jsonData.user.companyId) {",
                  "    pm.environment.set('companyId', jsonData.user.companyId);",
                  "}",
                  "if (pm.cookies.has('refreshToken')) {",
                  "    pm.environment.set('refreshToken', pm.cookies.get('refreshToken'));",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"{{userEmail}}\",\n    \"password\": \"{{userPassword}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "login"
              ]
            },
            "description": "Login to get access token"
          },
          "response": []
        },
        {
          "name": "Refresh Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData && jsonData.accessToken) {",
                  "    pm.environment.set('accessToken', jsonData.accessToken);",
                  "}",
                  "if (pm.cookies.has('refreshToken')) {",
                  "    pm.environment.set('refreshToken', pm.cookies.get('refreshToken'));",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"refreshToken\": \"{{refreshToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/refresh",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "refresh"
              ]
            },
            "description": "Refresh access token using refresh token"
          },
          "response": []
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auth/logout",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "logout"
              ]
            },
            "description": "Logout and invalidate the current session"
          },
          "response": []
        }
      ]
    },
    {
      "name": "2. Security",
      "description": "Security features including CSRF protection, session management, and account lockout",
      "item": [
        {
          "name": "Get CSRF Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData && jsonData.csrfToken) {",
                  "    pm.environment.set('csrfToken', jsonData.csrfToken);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/csrf-token",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "csrf-token"
              ]
            },
            "description": "Get a CSRF token for protected requests"
          },
          "response": []
        },
        {
          "name": "Get Active Sessions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/sessions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "sessions"
              ]
            },
            "description": "Get all active sessions for the current user"
          },
          "response": []
        }
      ]
    },
    {
      "name": "3. KYC Verification",
      "description": "KYC verification endpoints for PAN, Aadhaar, GSTIN, and bank accounts",
      "item": [
        {
          "name": "Get KYC Status",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/kyc/status",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "kyc",
                "status"
              ]
            },
            "description": "Get the current status of user's KYC verification process"
          },
          "response": []
        },
        {
          "name": "Verify PAN Card",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"pan\": \"{{panNumber}}\",\n    \"name\": \"{{userName}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/kyc/verify-pan",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "kyc",
                "verify-pan"
              ]
            },
            "description": "Verify PAN card in real-time using DeepVue API"
          },
          "response": []
        },
        {
          "name": "Verify Aadhaar",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"aadhaar\": \"{{aadhaarNumber}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/kyc/verify-aadhaar",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "kyc",
                "verify-aadhaar"
              ]
            },
            "description": "Verify Aadhaar in real-time using DeepVue API"
          },
          "response": []
        }
      ]
    },
    {
      "name": "4. Notifications",
      "description": "Notification endpoints for email, SMS, and WhatsApp",
      "item": [
        {
          "name": "Get Notification Preferences",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/notifications/preferences",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "notifications",
                "preferences"
              ]
            },
            "description": "Get user's notification preferences"
          },
          "response": []
        },
        {
          "name": "Send Test Email",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"{{userEmail}}\",\n    \"subject\": \"Test Email from Shipcrowd\",\n    \"message\": \"This is a test email from Shipcrowd notification system.\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/notifications/email/test",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "notifications",
                "email",
                "test"
              ]
            },
            "description": "Send a test email to the user"
          },
          "response": []
        },
        {
          "name": "Send Test SMS",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"phoneNumber\": \"{{testPhoneNumber}}\",\n    \"message\": \"This is a test SMS from Shipcrowd notification system.\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/notifications/sms/test",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "notifications",
                "sms",
                "test"
              ]
            },
            "description": "Send a test SMS to the user"
          },
          "response": []
        }
      ]
    },
    {
      "name": "5. Business",
      "description": "Business functionality including company, warehouse, and inventory management",
      "item": [
        {
          "name": "Create Company",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"{{companyName}}\",\n    \"legalName\": \"{{companyName}} Pvt Ltd\",\n    \"email\": \"{{userEmail}}\",\n    \"phone\": \"{{testPhoneNumber}}\",\n    \"address\": {\n        \"line1\": \"123 Main St\",\n        \"line2\": \"Suite 101\",\n        \"city\": \"Mumbai\",\n        \"state\": \"Maharashtra\",\n        \"country\": \"India\",\n        \"postalCode\": \"400001\"\n    },\n    \"taxInfo\": {\n        \"gstin\": \"{{gstinNumber}}\",\n        \"pan\": \"{{panNumber}}\"\n    }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/companies",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "companies"
              ]
            },
            "description": "Create a new company"
          },
          "response": []
        },
        {
          "name": "Create Warehouse",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Main Warehouse\",\n    \"code\": \"WH001\",\n    \"type\": \"fulfillment\",\n    \"address\": {\n        \"line1\": \"123 Warehouse St\",\n        \"city\": \"Mumbai\",\n        \"state\": \"Maharashtra\",\n        \"country\": \"India\",\n        \"postalCode\": \"400001\"\n    },\n    \"contactPerson\": {\n        \"name\": \"{{userName}}\",\n        \"email\": \"{{userEmail}}\",\n        \"phone\": \"{{testPhoneNumber}}\"\n    },\n    \"capacity\": {\n        \"area\": 5000,\n        \"areaUnit\": \"sqft\",\n        \"storageCapacity\": 10000,\n        \"storageUnit\": \"items\"\n    }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/warehouses",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "companies",
                "{{companyId}}",
                "warehouses"
              ]
            },
            "description": "Create a new warehouse"
          },
          "response": []
        },
        {
          "name": "Add Product",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Test Product\",\n    \"sku\": \"TP-001\",\n    \"description\": \"This is a test product\",\n    \"category\": \"Electronics\",\n    \"dimensions\": {\n        \"length\": 10,\n        \"width\": 5,\n        \"height\": 2,\n        \"unit\": \"cm\"\n    },\n    \"weight\": {\n        \"value\": 0.5,\n        \"unit\": \"kg\"\n    },\n    \"price\": {\n        \"value\": 999.99,\n        \"currency\": \"INR\"\n    },\n    \"attributes\": {\n        \"color\": \"Black\",\n        \"material\": \"Plastic\",\n        \"brand\": \"Test Brand\"\n    }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/products",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "companies",
                "{{companyId}}",
                "products"
              ]
            },
            "description": "Add a new product to the inventory"
          },
          "response": []
        },
        {
          "name": "Create Order",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT access token"
              },
              {
                "key": "x-csrf-token",
                "value": "{{csrfToken}}",
                "description": "CSRF token for protection"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"customer\": {\n        \"name\": \"Customer Name\",\n        \"email\": \"customer@example.com\",\n        \"phone\": \"+919876543210\",\n        \"address\": {\n            \"line1\": \"123 Customer St\",\n            \"city\": \"Mumbai\",\n            \"state\": \"Maharashtra\",\n            \"country\": \"India\",\n            \"postalCode\": \"400001\"\n        }\n    },\n    \"items\": [\n        {\n            \"productId\": \"{{productId}}\",\n            \"quantity\": 2,\n            \"price\": 999.99\n        }\n    ],\n    \"shipping\": {\n        \"method\": \"standard\",\n        \"cost\": 100,\n        \"estimatedDelivery\": \"2023-12-25\"\n    },\n    \"payment\": {\n        \"method\": \"cod\",\n        \"status\": \"pending\"\n    },\n    \"notes\": \"Test order\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/orders",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "companies",
                "{{companyId}}",
                "orders"
              ]
            },
            "description": "Create a new order"
          },
          "response": []
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Generate a CSRF token if not already set",
          "if (!pm.environment.get('csrfToken')) {",
          "    var uuid = require('uuid');",
          "    pm.environment.set('csrfToken', uuid.v4());",
          "}",
          "",
          "// Ensure user variables are set with valid test values",
          "if (!pm.environment.get('userEmail')) {",
          "    pm.environment.set('userEmail', 'business.cyperstudio@gmail.com');",
          "}",
          "if (!pm.environment.get('userPassword')) {",
          "    pm.environment.set('userPassword', 'Password123!');",
          "}",
          "if (!pm.environment.get('userName')) {",
          "    pm.environment.set('userName', 'Dhiraj Giri');",
          "}",
          "if (!pm.environment.get('userRole')) {",
          "    pm.environment.set('userRole', 'seller');",
          "}",
          "if (!pm.environment.get('testPhoneNumber')) {",
          "    pm.environment.set('testPhoneNumber', '+919904392992');",
          "}",
          "if (!pm.environment.get('panNumber')) {",
          "    pm.environment.set('panNumber', 'DPYPG3276Q');",
          "}",
          "if (!pm.environment.get('aadhaarNumber')) {",
          "    pm.environment.set('aadhaarNumber', '350405320859');",
          "}",
          "if (!pm.environment.get('gstinNumber')) {",
          "    pm.environment.set('gstinNumber', '24DPYPG3276Q1ZW');",
          "}",
          "",
          "// Set Origin header to mimic request from frontend",
          "const clientUrl = pm.environment.get('clientUrl') || 'http://localhost:3000';",
          "pm.request.headers.add({",
          "    key: 'Origin',",
          "    value: clientUrl",
          "});"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5005",
      "type": "string",
      "description": "Base URL for the Shipcrowd API server"
    },
    {
      "key": "companyName",
      "value": "Cyper Studio",
      "type": "string",
      "description": "Name of the company for testing"
    }
  ]
}