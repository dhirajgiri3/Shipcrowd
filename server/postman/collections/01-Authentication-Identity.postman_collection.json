{
    "info": {
        "_postman_id": "shipcrowd-auth-v2",
        "name": "01 - Authentication & Identity (UPDATED)",
        "description": "## Authentication & Identity Collection - COMPLETE & UP-TO-DATE\n\n**Domain:** User authentication, session management, profile operations, MFA, OAuth\n**Total Endpoints:** 42\n**Version:** 2.0.0\n**Last Updated:** 2026-01-15\n\n### Complete Coverage\n‚úÖ User Registration & Email Verification (4 endpoints)\n‚úÖ Login Methods: Email/Password, Magic Link, OAuth (5 endpoints)\n‚úÖ Token Management: Refresh, Revoke (2 endpoints)\n‚úÖ Password Operations: Reset, Change, Set (4 endpoints)\n‚úÖ Session Management: View, Revoke (3 endpoints)\n‚úÖ Profile Management: 8 operations (8 endpoints)\n‚úÖ Account Recovery (2 endpoints)\n‚úÖ Email Management (2 endpoints)\n‚úÖ Google OAuth Integration (2 endpoints)\n‚úÖ MFA/2FA Complete Flow (7 endpoints)\n‚úÖ CSRF Token Management (1 endpoint)\n\n### Quick Start\n1. Health Check ‚Üí Get CSRF Token\n2. Register ‚Üí Verify Email ‚Üí Login\n3. All endpoints auto-use stored tokens\n\n### Auto Features\nüîÑ Token auto-refresh (no manual work!)\n‚úÖ Global test assertions\nüìä Environment variable management\nüìù Comprehensive documentation\nüîê Automatic CSRF token handling\n\n### Important Notes\n- All state-changing operations require CSRF token (auto-handled)\n- Rate limiting enforced on sensitive endpoints\n- MFA flow: Login ‚Üí Get temp token ‚Üí Verify MFA ‚Üí Get access token\n- Sessions support device tracking and concurrent session limits",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{ACCESS_TOKEN}}",
                "type": "string"
            }
        ]
    },
    "event": [
        {
            "listen": "prerequest",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "// AUTO TOKEN REFRESH LOGIC",
                    "const tokenExpiry = pm.environment.get('ACCESS_TOKEN_EXPIRY');",
                    "const now = Date.now();",
                    "",
                    "if (tokenExpiry && (tokenExpiry - now) < 30000) {",
                    "    const refreshToken = pm.environment.get('REFRESH_TOKEN');",
                    "    if (refreshToken) {",
                    "        console.log('üîÑ Token expiring soon, refreshing...');",
                    "        pm.sendRequest({",
                    "            url: pm.environment.get('BASE_URL') + '/auth/refresh',",
                    "            method: 'POST',",
                    "            header: { 'Content-Type': 'application/json' },",
                    "            body: {",
                    "                mode: 'raw',",
                    "                raw: JSON.stringify({ refreshToken: refreshToken })",
                    "            }",
                    "        }, function (err, res) {",
                    "            if (!err && res.code === 200) {",
                    "                const data = res.json().data;",
                    "                pm.environment.set('ACCESS_TOKEN', data.accessToken);",
                    "                pm.environment.set('REFRESH_TOKEN', data.refreshToken);",
                    "                pm.environment.set('ACCESS_TOKEN_EXPIRY', Date.now() + 15*60*1000);",
                    "                console.log('‚úÖ Token refreshed');",
                    "            }",
                    "        });",
                    "    }",
                    "}"
                ]
            }
        },
        {
            "listen": "test",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "// GLOBAL TEST ASSERTIONS",
                    "pm.test('‚ö° Response time < 5s', () => pm.expect(pm.response.responseTime).to.be.below(5000));",
                    "if (pm.response.code !== 302) {",
                    "    pm.test('üìÑ Correct content type', () => pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json'));",
                    "}",
                    "if (pm.response.code >= 200 && pm.response.code < 300) {",
                    "    pm.test('‚úÖ Standard structure', () => {",
                    "        const json = pm.response.json();",
                    "        pm.expect(json).to.have.property('success');",
                    "        pm.expect(json).to.have.property('data');",
                    "    });",
                    "}"
                ]
            }
        }
    ],
    "item": [
        {
            "name": "1. Setup & Health",
            "description": "Essential setup requests",
            "item": [
                {
                    "name": "Health Check",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/../health",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "..",
                                "health"
                            ]
                        },
                        "description": "Verify server is running"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Server healthy', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const json = pm.response.json();",
                                    "    pm.expect(json.status).to.equal('ok');",
                                    "    console.log('‚úÖ Server Status:', json.status);",
                                    "    console.log('‚è±Ô∏è  Uptime:', Math.floor(json.uptime), 'seconds');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Get CSRF Token",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/auth/csrf-token",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "csrf-token"
                            ]
                        },
                        "description": "Get CSRF token for state-changing operations (Redis-based)"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('CSRF token received', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const token = pm.response.json().data.csrfToken;",
                                    "    pm.expect(token).to.have.lengthOf(64);",
                                    "    pm.environment.set('CSRF_TOKEN', token);",
                                    "    console.log('üîê CSRF Token stored (64 chars)');",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "2. Registration & Email",
            "description": "User registration and email verification",
            "item": [
                {
                    "name": "Register New User",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}",
                                "description": "Required for registration"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{TEST_EMAIL}}\",\n  \"password\": \"{{TEST_PASSWORD}}\",\n  \"name\": \"Test User\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/register",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "register"
                            ]
                        },
                        "description": "Register a new user. Verification email is sent automatically."
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('User registered', () => {",
                                    "    pm.response.to.have.status(201);",
                                    "    const data = pm.response.json().data;",
                                    "    pm.environment.set('USER_ID', data.userId);",
                                    "    pm.environment.set('COMPANY_ID', data.companyId);",
                                    "    pm.environment.set('REGISTERED_EMAIL', data.email);",
                                    "    console.log('üë§ User ID:', data.userId);",
                                    "    console.log('üè¢ Company ID:', data.companyId);",
                                    "    console.log('üìß Check email for verification token');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Verify Email",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"token\": \"<RAW_VERIFICATION_TOKEN_FROM_EMAIL>\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/verify-email",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "verify-email"
                            ]
                        },
                        "description": "Verify email with token received via email. Token is RAW (64 hex chars), not hashed."
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Email verified', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Email verified successfully');",
                                    "    console.log('üéâ You can now login');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Resend Verification Email",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{TEST_EMAIL}}\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/resend-verification",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "resend-verification"
                            ]
                        },
                        "description": "Resend verification email if token expired or lost"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Verification email sent', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('üìß New verification email sent');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Check Password Strength",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"password\": \"TestPassword123!\",\n  \"email\": \"{{TEST_EMAIL}}\",\n  \"name\": \"Test User\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/check-password-strength",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "check-password-strength"
                            ]
                        },
                        "description": "Check password strength before registration/change"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Password strength checked', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const data = pm.response.json().data;",
                                    "    console.log('üí™ Strength Score:', data.score, '/4');",
                                    "    console.log('‚úÖ Is Strong:', data.isStrong);",
                                    "    if (data.suggestions) {",
                                    "        console.log('üí° Suggestions:', data.suggestions);",
                                    "    }",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "3. Login & Tokens",
            "description": "Login and token management",
            "item": [
                {
                    "name": "Login with Email & Password",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{TEST_EMAIL}}\",\n  \"password\": \"{{TEST_PASSWORD}}\",\n  \"rememberMe\": true\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/login",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Login with email and password. If MFA enabled, returns temp token instead."
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Login successful', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const data = pm.response.json().data;",
                                    "    ",
                                    "    if (data.mfaRequired) {",
                                    "        // MFA flow",
                                    "        pm.environment.set('MFA_TEMP_TOKEN', data.tempToken);",
                                    "        console.log('üîê MFA Required - use temp token to verify');",
                                    "    } else {",
                                    "        // Normal flow",
                                    "        pm.environment.set('ACCESS_TOKEN', data.accessToken);",
                                    "        pm.environment.set('REFRESH_TOKEN', data.refreshToken);",
                                    "        pm.environment.set('ACCESS_TOKEN_EXPIRY', Date.now() + 15*60*1000);",
                                    "        pm.environment.set('USER_ID', data.user.id);",
                                    "        pm.environment.set('COMPANY_ID', data.user.companyId);",
                                    "        pm.environment.set('USER_ROLE', data.user.role);",
                                    "        console.log('‚úÖ Logged in as:', data.user.email);",
                                    "        console.log('üë§ Role:', data.user.role);",
                                    "    }",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Refresh Access Token",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"refreshToken\": \"{{REFRESH_TOKEN}}\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/refresh",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "refresh"
                            ]
                        },
                        "description": "Refresh access token using refresh token. Both tokens are rotated."
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Token refreshed', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const data = pm.response.json().data;",
                                    "    // Update both tokens (rotation)",
                                    "    pm.environment.set('ACCESS_TOKEN', data.accessToken);",
                                    "    pm.environment.set('REFRESH_TOKEN', data.refreshToken);",
                                    "    pm.environment.set('ACCESS_TOKEN_EXPIRY', Date.now() + 15*60*1000);",
                                    "    console.log('‚úÖ Tokens refreshed (rotation applied)');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Get Current User",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/auth/me",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "me"
                            ]
                        },
                        "description": "Get current authenticated user details"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('User details retrieved', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const user = pm.response.json().data;",
                                    "    console.log('üë§ Name:', user.name);",
                                    "    console.log('üìß Email:', user.email);",
                                    "    console.log('üè¢ Company:', user.companyId);",
                                    "    console.log('‚úÖ Email Verified:', user.isEmailVerified);",
                                    "    console.log('üîê MFA Enabled:', user.security?.isMFAEnabled || false);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Logout",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/auth/logout",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "logout"
                            ]
                        },
                        "description": "Logout and revoke current session"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Logged out', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    // Clear tokens",
                                    "    pm.environment.unset('ACCESS_TOKEN');",
                                    "    pm.environment.unset('REFRESH_TOKEN');",
                                    "    pm.environment.unset('ACCESS_TOKEN_EXPIRY');",
                                    "    console.log('‚úÖ Logged out successfully');",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "4. Password Management",
            "description": "Password operations",
            "item": [
                {
                    "name": "Request Password Reset",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{TEST_EMAIL}}\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/reset-password",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "reset-password"
                            ]
                        },
                        "description": "Request password reset email"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Reset email sent', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('üìß Password reset email sent (if email exists)');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Reset Password with Token",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"token\": \"<RESET_TOKEN_FROM_EMAIL>\",\n  \"password\": \"NewSecurePass123!@#\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/reset-password/confirm",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "reset-password",
                                "confirm"
                            ]
                        },
                        "description": "Complete password reset with token from email"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Password reset', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Password reset successfully');",
                                    "    console.log('üîë Use new password to login');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Change Password (Authenticated)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"currentPassword\": \"{{TEST_PASSWORD}}\",\n  \"newPassword\": \"NewSecurePass123!@#\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/change-password",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "change-password"
                            ]
                        },
                        "description": "Change password for logged-in user (requires current password)"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Password changed', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Password changed successfully');",
                                    "    console.log('üîÑ All other sessions revoked');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Set Password (OAuth Users)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"password\": \"NewSecurePass123!@#\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/set-password",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "set-password"
                            ]
                        },
                        "description": "Set password for OAuth users to enable email/password login"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Password set', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Password set successfully');",
                                    "    console.log('üîë Can now login with email/password');",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "5. Magic Link (Passwordless)",
            "description": "Passwordless authentication",
            "item": [
                {
                    "name": "Request Magic Link",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{TEST_EMAIL}}\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/magic-link",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "magic-link"
                            ]
                        },
                        "description": "Request magic link for passwordless login"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Magic link sent', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('üìß Magic link sent to email');",
                                    "    console.log('‚è∞ Link expires in 15 minutes');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Verify Magic Link",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"token\": \"<MAGIC_LINK_TOKEN>\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/verify-magic-link",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "verify-magic-link"
                            ]
                        },
                        "description": "Verify magic link and login"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Magic link verified', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const data = pm.response.json().data;",
                                    "    pm.environment.set('ACCESS_TOKEN', data.accessToken);",
                                    "    pm.environment.set('REFRESH_TOKEN', data.refreshToken);",
                                    "    pm.environment.set('ACCESS_TOKEN_EXPIRY', Date.now() + 15*60*1000);",
                                    "    console.log('‚úÖ Logged in via magic link');",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "6. Account Recovery",
            "description": "Account unlock operations",
            "item": [
                {
                    "name": "Request Account Unlock",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{TEST_EMAIL}}\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/recovery/request-unlock",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "recovery",
                                "request-unlock"
                            ]
                        },
                        "description": "Request account unlock email for locked accounts (5 failed login attempts)"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Unlock email sent', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('üìß Account recovery email sent');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Verify Recovery Token",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"token\": \"<RECOVERY_TOKEN>\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/recovery/verify-unlock",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "recovery",
                                "verify-unlock"
                            ]
                        },
                        "description": "Verify recovery token and unlock account"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Account unlocked', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Account unlocked successfully');",
                                    "    console.log('üîì Failed login attempts reset');",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "7. Email Management",
            "description": "Email change operations",
            "item": [
                {
                    "name": "Change Email",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"newEmail\": \"newemail@example.com\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/change-email",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "change-email"
                            ]
                        },
                        "description": "Request email change (sends verification to new email)"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Email change initiated', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('üìß Verification sent to new email');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Verify Email Change",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"token\": \"<EMAIL_CHANGE_TOKEN>\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/verify-email-change",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "verify-email-change"
                            ]
                        },
                        "description": "Verify and complete email change"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Email changed', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Email changed successfully');",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "8. Session Management",
            "description": "Manage user sessions",
            "item": [
                {
                    "name": "Get All Sessions",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/sessions",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "sessions"
                            ]
                        },
                        "description": "Get all active sessions for current user with device info"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Sessions retrieved', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const sessions = pm.response.json().data.sessions;",
                                    "    console.log('üì± Active Sessions:', sessions.length);",
                                    "    sessions.forEach((s, i) => {",
                                    "        console.log(`Session ${i+1}:`, s.deviceInfo?.browser, s.deviceInfo?.os);",
                                    "    });",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Revoke Specific Session",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/sessions/:sessionId",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "sessions",
                                ":sessionId"
                            ],
                            "variable": [
                                {
                                    "key": "sessionId",
                                    "value": "SESSION_ID_HERE"
                                }
                            ]
                        },
                        "description": "Revoke a specific session by ID"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Session revoked', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Session revoked successfully');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Revoke All Sessions",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/sessions",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "sessions"
                            ]
                        },
                        "description": "Revoke all sessions except current one"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('All sessions revoked', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ All other sessions revoked');",
                                    "    console.log('üîê Current session still active');",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "9. Profile Management",
            "description": "User profile operations",
            "item": [
                {
                    "name": "Get Profile Completion",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/profile/completion",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "profile",
                                "completion"
                            ]
                        },
                        "description": "Get profile completion status and percentage"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Profile completion retrieved', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const data = pm.response.json().data;",
                                    "    console.log('üìä Completion:', data.percentage + '%');",
                                    "    console.log('‚úÖ Complete:', data.complete);",
                                    "    console.log('üìù Missing:', data.missing || 'None');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Update Basic Profile",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\",\n  \"bio\": \"E-commerce seller\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/profile/basic",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "profile",
                                "basic"
                            ]
                        },
                        "description": "Update basic profile information"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Profile updated', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Basic profile updated');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Update Address",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"street\": \"123 Main St\",\n  \"city\": \"Bangalore\",\n  \"state\": \"Karnataka\",\n  \"pincode\": \"560001\",\n  \"country\": \"India\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/profile/address",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "profile",
                                "address"
                            ]
                        },
                        "description": "Update address information"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Address updated', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Address updated');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Update Personal Info",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"dateOfBirth\": \"1990-01-01\",\n  \"gender\": \"male\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/profile/personal",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "profile",
                                "personal"
                            ]
                        },
                        "description": "Update personal information"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Personal info updated', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Personal info updated');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Update Social Links",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"linkedin\": \"https://linkedin.com/in/johndoe\",\n  \"twitter\": \"@johndoe\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/profile/social",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "profile",
                                "social"
                            ]
                        },
                        "description": "Update social links"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Social links updated', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Social links updated');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Update Preferences",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"language\": \"en\",\n  \"timezone\": \"Asia/Kolkata\",\n  \"notifications\": {\n    \"email\": true,\n    \"sms\": false,\n    \"whatsapp\": true\n  }\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/profile/preferences",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "profile",
                                "preferences"
                            ]
                        },
                        "description": "Update user preferences"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Preferences updated', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Preferences updated');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Get Profile Prompts",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/profile/prompts",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "profile",
                                "prompts"
                            ]
                        },
                        "description": "Get profile completion prompts"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Prompts retrieved', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const prompts = pm.response.json().data.prompts;",
                                    "    console.log('üìã Active Prompts:', prompts.length);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Dismiss Profile Prompt",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "X-CSRF-Token",
                                "value": "{{CSRF_TOKEN}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"promptId\": \"complete-profile\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/profile/dismiss-prompt",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "profile",
                                "dismiss-prompt"
                            ]
                        },
                        "description": "Dismiss profile completion prompt"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Prompt dismissed', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ Prompt dismissed');",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "10. MFA / 2FA",
            "description": "Multi-factor authentication",
            "item": [
                {
                    "name": "Setup TOTP (Get QR Code)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/auth/mfa/setup-totp",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "mfa",
                                "setup-totp"
                            ]
                        },
                        "description": "Generate TOTP secret and QR code for authenticator app"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('TOTP setup initiated', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const data = pm.response.json().data;",
                                    "    pm.environment.set('MFA_SECRET', data.secret);",
                                    "    console.log('üì± Scan QR code:', data.qrCode);",
                                    "    console.log('üîë Secret:', data.secret);",
                                    "    console.log('‚ñ∂Ô∏è  Next: Verify TOTP to enable MFA');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Verify TOTP & Enable MFA",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"token\": \"123456\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/mfa/verify-totp",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "mfa",
                                "verify-totp"
                            ]
                        },
                        "description": "Verify TOTP code and enable MFA"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('MFA enabled', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const data = pm.response.json().data;",
                                    "    console.log('‚úÖ MFA enabled successfully');",
                                    "    console.log('üîê Backup codes:', data.backupCodes);",
                                    "    console.log('‚ö†Ô∏è  Save backup codes securely!');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Get MFA Status",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/auth/mfa/status",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "mfa",
                                "status"
                            ]
                        },
                        "description": "Get current MFA status"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('MFA status retrieved', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const data = pm.response.json().data;",
                                    "    console.log('üîê MFA Enabled:', data.isMFAEnabled);",
                                    "    console.log('üì± Method:', data.method || 'None');",
                                    "    console.log('üîë Backup Codes:', data.backupCodesRemaining || 0);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Get Backup Codes",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            }
                        ],
                        "url": {
                            "raw": "{{BASE_URL}}/auth/mfa/backup-codes",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "mfa",
                                "backup-codes"
                            ]
                        },
                        "description": "Get backup codes (regenerates new codes)"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Backup codes generated', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const codes = pm.response.json().data.backupCodes;",
                                    "    console.log('üîë New Backup Codes:', codes);",
                                    "    console.log('‚ö†Ô∏è  Old codes are invalidated');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Use Backup Code",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{MFA_TEMP_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"backupCode\": \"BACKUP-CODE-HERE\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/mfa/use-backup-code",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "mfa",
                                "use-backup-code"
                            ]
                        },
                        "description": "Login using backup code (temp token from login)"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Backup code verified', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    const data = pm.response.json().data;",
                                    "    pm.environment.set('ACCESS_TOKEN', data.accessToken);",
                                    "    pm.environment.set('REFRESH_TOKEN', data.refreshToken);",
                                    "    console.log('‚úÖ Logged in with backup code');",
                                    "    console.log('‚ö†Ô∏è  This code is now used');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Disable MFA",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"password\": \"{{TEST_PASSWORD}}\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/mfa/disable-totp",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "mfa",
                                "disable-totp"
                            ]
                        },
                        "description": "Disable MFA (requires password)"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('MFA disabled', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ MFA disabled successfully');",
                                    "    console.log('‚ö†Ô∏è  Account now uses single-factor auth');",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "Enforce MFA (Admin)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{ACCESS_TOKEN}}"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"companyId\": \"{{COMPANY_ID}}\",\n  \"enforce\": true\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/auth/mfa/enforce",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "mfa",
                                "enforce"
                            ]
                        },
                        "description": "Enforce MFA for all company users (admin only)"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('MFA enforcement updated', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "    console.log('‚úÖ MFA enforcement updated');",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "11. OAuth Integration",
            "description": "Google OAuth flow",
            "item": [
                {
                    "name": "Initiate Google OAuth",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/auth/google",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "google"
                            ]
                        },
                        "description": "Initiates Google OAuth flow - redirects to Google login"
                    }
                },
                {
                    "name": "Google OAuth Callback",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/auth/google/callback",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "auth",
                                "google",
                                "callback"
                            ]
                        },
                        "description": "OAuth callback endpoint - called by Google after authentication. Tokens set as httpOnly cookies."
                    }
                }
            ]
        }
    ]
}
